# æŠ–éŸ³è¯„è®ºæ•°æ®è·å–æµ‹è¯•ç»“æœæŠ¥å‘Š

**æµ‹è¯•æ—¶é—´**: 2025å¹´10æœˆ20æ—¥
**æµ‹è¯•ç›®çš„**: éªŒè¯TikHub APIè·å–æŠ–éŸ³è§†é¢‘è¯„è®ºæ•°æ®çš„åŠŸèƒ½

---

## âœ… æµ‹è¯•ç»“æœæ€»ç»“

**çŠ¶æ€**: å…¨éƒ¨é€šè¿‡ âœ…

æ‰€æœ‰åŠŸèƒ½å‡æµ‹è¯•æˆåŠŸï¼Œèƒ½å¤Ÿå®Œæ•´è·å–æŠ–éŸ³è§†é¢‘çš„è¯„è®ºæ•°æ®ã€ç»Ÿè®¡æ•°æ®å’Œè§†é¢‘è¯¦æƒ…ã€‚

---

## ğŸ“ æµ‹è¯•å†…å®¹

### 1. æµ‹è¯•é“¾æ¥

```
æœ¬åœ°ï¼Œ80ã¡ä»¥ä¸Šçš„æˆ¿å­è£…ä¿®è¦å¤šå°‘é’±ï¼Ÿè¾“å…¥é¢ç§¯ï¼Œå…è´¹è·å–æŠ¥ä»·#å·¦å°é’éšè—çš„è£…ä¿®ä¸»ç†äºº#åˆ›è‰ºè£…é¥°
https://v.douyin.com/fObbpu9fOfk/
å¤åˆ¶æ­¤é“¾æ¥ï¼Œæ‰“å¼€ã€æŠ–éŸ³ã€‘ï¼Œç›´æ¥è§‚çœ‹è§†é¢‘ï¼
```

### 2. é“¾æ¥è§£æç»“æœ

- **åŸå§‹é“¾æ¥**: `https://v.douyin.com/fObbpu9fOfk`
- **è§£æåURL**: `https://www.douyin.com/video/7504265383927369001?previous_page=web_code_link`
- **æå–çš„è§†é¢‘ID**: `7504265383927369001`

---

## ğŸ¥ è§†é¢‘åŸºæœ¬ä¿¡æ¯

| å­—æ®µ | å€¼ |
|------|-----|
| **è§†é¢‘ID** | 7504265383927369001 |
| **æ ‡é¢˜** | æœ¬åœ°ï¼Œ80ã¡ä»¥ä¸Šçš„æˆ¿å­è£…ä¿®è¦å¤šå°‘é’±ï¼Ÿè¾“å…¥é¢ç§¯ï¼Œå…è´¹è·å–æŠ¥ä»·#å·¦å°é’éšè—çš„è£…ä¿®ä¸»ç†äºº#åˆ›è‰ºè£…é¥° |
| **ä½œè€…** | åˆ›è‰ºè€å»–èŠè£…ä¿® |
| **å‘å¸ƒæ—¶é—´** | 2025/5/14 19:42:23 |
| **æ—¶é•¿** | 30.8ç§’ (30837ms) |

---

## ğŸ“Š è§†é¢‘ç»Ÿè®¡æ•°æ®

### ä»è§†é¢‘è¯¦æƒ…è·å–çš„ç»Ÿè®¡æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| è¯„è®ºæ•° | 1,131 |
| ç‚¹èµæ•° | 37,148 |
| åˆ†äº«æ•° | 5,392 |
| æ”¶è—æ•° | 12,677 |
| æ’­æ”¾æ•°ï¼ˆè¯¦æƒ…æ¥å£ï¼‰ | 0 (æœªæä¾›) |

### ä»ç»Ÿè®¡æ•°æ®æ¥å£è·å–çš„æ•°æ®

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| ç‚¹èµæ•° | 37,148 |
| æ’­æ”¾æ•° | **20,278,377** (çº¦2027ä¸‡) |
| åˆ†äº«æ•° | 585 |
| ä¸‹è½½æ•° | 35 |

> **æ³¨æ„**: ç»Ÿè®¡æ•°æ®æ¥å£æä¾›äº†å‡†ç¡®çš„æ’­æ”¾æ•°ï¼Œè¿™æ˜¯è§†é¢‘è¯¦æƒ…æ¥å£æ— æ³•è·å–çš„ã€‚

---

## ğŸ’¬ è¯„è®ºæ•°æ®

### è¯„è®ºæ¦‚è§ˆ

- **è¯„è®ºæ€»æ•°**: 1,131æ¡
- **ç¬¬1é¡µè·å–**: 20æ¡è¯„è®º
- **ç¬¬2é¡µè·å–**: 20æ¡è¯„è®º
- **æ˜¯å¦æœ‰æ›´å¤š**: æ˜¯
- **åˆ†é¡µæ–¹å¼**: æ¸¸æ ‡åˆ†é¡µ (cursor: 0 â†’ 20 â†’ 40...)

### è¯„è®ºç¤ºä¾‹ï¼ˆç¬¬1é¡µå‰5æ¡ï¼‰

#### è¯„è®º #1
- **ID**: 7512456248164467516
- **ç”¨æˆ·**: êª‹êª†ê«âµÂ²â°ä¸ƒå¦¹ğŸ€á­„ (uid: 3786361588418531)
- **å†…å®¹**: è¿™å¥—è£…ä¿®å¥½æ¼‚äº®[èµ][èµ][èµ]
- **æ—¶é—´**: 2025/6/5 21:27:05
- **ç‚¹èµ**: 1
- **å›å¤æ•°**: 2

#### è¯„è®º #2
- **ID**: 7523028412739830564
- **ç”¨æˆ·**: å•Šç©· (uid: 2467770523199703)
- **å†…å®¹**: çœ‹æ•ˆæœå›¾ç›¸å½“ä¸é”™ï¼Œå€¼å¾—æ¨è[æ¯”å¿ƒ][æ¯”å¿ƒ][æ¯”å¿ƒ][ç»™åŠ›][ç»™åŠ›]
- **æ—¶é—´**: 2025/7/4 09:12:36
- **ç‚¹èµ**: 1
- **å›å¤æ•°**: 3

#### è¯„è®º #3
- **ID**: 7527074986806297382
- **ç”¨æˆ·**: è’™å—è’‹åŠ±â•­(â•¯Îµâ•°)â•® (uid: 59239106945)
- **å†…å®¹**: è¿™è£…ä¿®è®¾è®¡çš„ä¸é”™ï¼Œå¾ˆæ¼‚äº®çš„å€¼å¾—ğŸ‰ä¿¡èµ–ï¼Œèµ[èµ][èµ][èµ][èµ][èµ]
- **æ—¶é—´**: 2025/7/15 06:55:23
- **ç‚¹èµ**: 2
- **å›å¤æ•°**: 0

#### è¯„è®º #4
- **ID**: 7526867625437070090
- **ç”¨æˆ·**: è‹ç”³ç”³ (uid: 1811618293885053)
- **å†…å®¹**: è¿™è£…ä¿®è®¾è®¡çš„ä¸é”™ï¼Œå¾ˆæ¼‚äº®çš„å€¼å¾—ğŸ‰ä¿¡èµ–ï¼Œèµ[èµ][èµ][èµ][èµ][èµ]
- **æ—¶é—´**: 2025/7/14 17:30:39
- **ç‚¹èµ**: 3
- **å›å¤æ•°**: 0

#### è¯„è®º #5
- **ID**: 7519906625081246483
- **ç”¨æˆ·**: çªå¦ˆ (uid: 1213467691066877)
- **å†…å®¹**: æˆ‘å®¶ä¹Ÿæ˜¯åˆ›è‰ºè£…çš„ï¼ŒçœŸä¸é”™[èµ]
- **æ—¶é—´**: 2025/6/25 23:18:25
- **ç‚¹èµ**: 8
- **å›å¤æ•°**: 0

---

## ğŸ”§ å®ç°çš„åŠŸèƒ½

### 1. ç±»å‹å®šä¹‰æ‰©å±• (`lib/tikhub/types.ts`)

æ–°å¢ä»¥ä¸‹TypeScriptç±»å‹å®šä¹‰ï¼š

```typescript
// è¯„è®ºæ•°æ®
interface DouyinComment {
  cid: string                     // è¯„è®ºID
  text: string                    // è¯„è®ºæ–‡æœ¬
  create_time: number             // åˆ›å»ºæ—¶é—´æˆ³
  digg_count: number              // ç‚¹èµæ•°
  reply_comment_total: number     // å›å¤æ•°
  user: {                         // ç”¨æˆ·ä¿¡æ¯
    uid: string
    sec_uid: string
    nickname: string
    avatar_thumb: {
      url_list: string[]
    }
  }
  reply_id?: string               // å›å¤çš„è¯„è®ºID
  label_text?: string             // æ ‡ç­¾æ–‡æœ¬
  stick_position?: number         // ç½®é¡¶ä½ç½®
}

// è¯„è®ºå“åº”
interface DouyinVideoCommentsResponse {
  comments: DouyinComment[]
  cursor: number                  // ä¸‹ä¸€é¡µæ¸¸æ ‡
  has_more: boolean               // æ˜¯å¦æœ‰æ›´å¤š
  total: number                   // è¯„è®ºæ€»æ•°
  status_code: number
}

// ç»Ÿè®¡æ•°æ®å“åº”
interface DouyinVideoStatisticsResponse {
  statistics: Array<{
    aweme_id: string
    comment_count: number
    digg_count: number
    download_count: number
    play_count: number            // ç²¾ç¡®çš„æ’­æ”¾æ•°
    share_count: number
    collect_count: number
    forward_count: number
  }>
  status_code: number
}
```

### 2. TikHubå®¢æˆ·ç«¯æ‰©å±• (`lib/tikhub/client.ts`)

æ–°å¢ä»¥ä¸‹æ–¹æ³•ï¼š

```typescript
// è·å–è§†é¢‘è¯„è®º
async getVideoComments(params: GetVideoCommentsParams): Promise<DouyinVideoCommentsResponse>

// è·å–è§†é¢‘ç»Ÿè®¡æ•°æ®ï¼ˆç²¾ç¡®çš„æ’­æ”¾æ•°ï¼‰
async getVideoStatistics(params: GetVideoStatisticsParams): Promise<DouyinVideoStatisticsResponse>
```

### 3. æµ‹è¯•è„šæœ¬ (`tests/manual/test-douyin-comments.ts`)

å®Œæ•´çš„ç«¯åˆ°ç«¯æµ‹è¯•è„šæœ¬ï¼ŒåŒ…æ‹¬ï¼š
- âœ… é“¾æ¥è§£æ
- âœ… è§†é¢‘è¯¦æƒ…è·å–
- âœ… ç»Ÿè®¡æ•°æ®è·å–
- âœ… è¯„è®ºæ•°æ®è·å–ï¼ˆå¤šé¡µï¼‰
- âœ… å®Œæ•´JSONæ•°æ®è¾“å‡º

---

## ğŸ¯ APIç«¯ç‚¹

### 1. è·å–è§†é¢‘è¯„è®º

```
GET /api/v1/douyin/app/v3/fetch_video_comments
```

**å‚æ•°**:
- `aweme_id` (å¿…éœ€): è§†é¢‘ID
- `cursor` (å¯é€‰): æ¸¸æ ‡ï¼Œé»˜è®¤0
- `count` (å¯é€‰): æ•°é‡ï¼Œé»˜è®¤20

**å“åº”å­—æ®µ**:
- `comments[]`: è¯„è®ºåˆ—è¡¨
- `cursor`: ä¸‹ä¸€é¡µæ¸¸æ ‡
- `has_more`: æ˜¯å¦æœ‰æ›´å¤šæ•°æ®
- `total`: è¯„è®ºæ€»æ•°

### 2. è·å–è§†é¢‘ç»Ÿè®¡æ•°æ®

```
GET /api/v1/douyin/app/v3/fetch_video_statistics
```

**å‚æ•°**:
- `aweme_ids` (å¿…éœ€): è§†é¢‘IDï¼Œå¤šä¸ªç”¨é€—å·åˆ†éš”ï¼ˆæœ€å¤š2ä¸ªï¼‰

**å“åº”å­—æ®µ**:
- `statistics[]`: ç»Ÿè®¡æ•°æ®åˆ—è¡¨
  - `comment_count`: è¯„è®ºæ•°
  - `digg_count`: ç‚¹èµæ•°
  - `play_count`: **æ’­æ”¾æ•°** (é‡è¦ï¼)
  - `download_count`: ä¸‹è½½æ•°
  - `share_count`: åˆ†äº«æ•°
  - `collect_count`: æ”¶è—æ•°
  - `forward_count`: è½¬å‘æ•°

---

## ğŸ“¦ å®Œæ•´çš„æ•°æ®ç»“æ„

### è¯„è®ºæ•°æ®å­—æ®µ

æ¯æ¡è¯„è®ºåŒ…å«ä»¥ä¸‹å®Œæ•´ä¿¡æ¯ï¼š

```json
{
  "cid": "7512456248164467516",
  "text": "è¿™å¥—è£…ä¿®å¥½æ¼‚äº®[èµ][èµ][èµ]",
  "aweme_id": "7504265383927369001",
  "create_time": 1749125225,
  "digg_count": 1,
  "status": 1,
  "user": {
    "uid": "3786361588418531",
    "short_id": "0",
    "nickname": "êª‹êª†ê«âµÂ²â°ä¸ƒå¦¹ğŸ€á­„",
    "avatar_thumb": {
      "uri": "...",
      "url_list": ["https://..."],
      "width": 720,
      "height": 720
    },
    "unique_id": "",
    "sec_uid": "MS4wLjABAAAA...",
    "region": "CN"
  },
  "reply_id": "0",
  "user_digged": 0,
  "reply_comment": null,
  "text_extra": [],
  "label_text": "",
  "label_type": -1,
  "reply_comment_total": 2,
  "reply_to_reply_id": "0",
  "is_author_digged": false,
  "stick_position": 0,
  "user_buried": false,
  "is_hot": true,
  "ip_label": "æ±Ÿè¥¿",
  "can_share": true,
  "item_comment_total": 1131,
  "level": 1,
  "content_type": 1,
  "is_folded": false
}
```

---

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### è¿è¡Œæµ‹è¯•è„šæœ¬

```bash
npx tsx tests/manual/test-douyin-comments.ts
```

### åœ¨ä»£ç ä¸­ä½¿ç”¨

```typescript
import { getTikHubClient } from '@/lib/tikhub/client'
import { parseDouyinVideoShare } from '@/lib/douyin/share-link'

// 1. è§£æåˆ†äº«é“¾æ¥
const parseResult = await parseDouyinVideoShare(shareText)
const videoId = parseResult.videoId

// 2. åˆ›å»ºå®¢æˆ·ç«¯
const client = getTikHubClient({
  apiKey: process.env.TIKHUB_API_KEY,
  baseURL: process.env.TIKHUB_API_BASE_URL,
})

// 3. è·å–è¯„è®ºï¼ˆç¬¬1é¡µï¼‰
const comments = await client.getVideoComments({
  aweme_id: videoId,
  cursor: 0,
  count: 20,
})

// 4. è·å–æ›´å¤šè¯„è®ºï¼ˆåˆ†é¡µï¼‰
if (comments.has_more) {
  const moreComments = await client.getVideoComments({
    aweme_id: videoId,
    cursor: comments.cursor,
    count: 20,
  })
}

// 5. è·å–ç²¾ç¡®çš„æ’­æ”¾æ•°
const statistics = await client.getVideoStatistics({
  aweme_ids: videoId,
})
console.log('æ’­æ”¾æ•°:', statistics.statistics[0].play_count)
```

---

## ğŸ¨ æ•°æ®åˆ†æä»·å€¼

### 1. å†…å®¹åˆ†æ
- **è¯„è®ºæƒ…æ„Ÿåˆ†æ**: äº†è§£ç”¨æˆ·å¯¹è§†é¢‘çš„çœŸå®åé¦ˆ
- **çƒ­é—¨è¯„è®ºè¯†åˆ«**: é€šè¿‡ç‚¹èµæ•°ã€å›å¤æ•°è¯†åˆ«çƒ­é—¨è¯„è®º
- **ç”¨æˆ·äº’åŠ¨æ¨¡å¼**: åˆ†æè¯„è®ºæ—¶é—´åˆ†å¸ƒã€ç”¨æˆ·åœ°åŸŸåˆ†å¸ƒ

### 2. ç”¨æˆ·æ´å¯Ÿ
- **ç”¨æˆ·ç”»åƒ**: é€šè¿‡è¯„è®ºç”¨æˆ·çš„æ˜µç§°ã€å¤´åƒã€åœ°åŒºåˆ†æå—ä¼—
- **ç²‰ä¸äº’åŠ¨**: è¯†åˆ«æ´»è·ƒç²‰ä¸å’Œæ½œåœ¨å•†æœº
- **å£ç¢‘ä¼ æ’­**: é€šè¿‡å›å¤é“¾åˆ†æä¼ æ’­è·¯å¾„

### 3. è¥é”€ä»·å€¼
- **è½¬åŒ–æ•ˆæœ**: è¯„è®ºä¸­çš„è´­ä¹°æ„å‘ã€å’¨è¯¢éœ€æ±‚
- **ç«äº‰åˆ†æ**: å¯¹æ¯”ä¸åŒè§†é¢‘çš„è¯„è®ºè´¨é‡
- **å†…å®¹ä¼˜åŒ–**: æ ¹æ®è¯„è®ºåé¦ˆä¼˜åŒ–å†…å®¹ç­–ç•¥

---

## ğŸ” å…³é”®å‘ç°

### 1. æ’­æ”¾æ•°è·å–
- âš ï¸ **é‡è¦**: è§†é¢‘è¯¦æƒ…æ¥å£(`fetch_one_video`)ä¸è¿”å›æ’­æ”¾æ•°
- âœ… **è§£å†³**: å¿…é¡»ä½¿ç”¨ç»Ÿè®¡æ•°æ®æ¥å£(`fetch_video_statistics`)è·å–å‡†ç¡®çš„æ’­æ”¾æ•°
- ğŸ“Š **æ•°æ®**: æœ¬æµ‹è¯•è§†é¢‘æ’­æ”¾æ•°ä¸º **2027ä¸‡** æ¬¡

### 2. è¯„è®ºæ•°æ®å®Œæ•´æ€§
- âœ… æ¯æ¡è¯„è®ºåŒ…å«å®Œæ•´çš„ç”¨æˆ·ä¿¡æ¯ï¼ˆæ˜µç§°ã€å¤´åƒã€åœ°åŒºï¼‰
- âœ… æ”¯æŒè¯„è®ºçš„ç‚¹èµæ•°ã€å›å¤æ•°
- âœ… åŒ…å«è¯„è®ºçš„IPå½’å±åœ°ï¼ˆå¦‚"æ±Ÿè¥¿"ã€"å®‰å¾½"ï¼‰
- âœ… æ ‡è®°çƒ­é—¨è¯„è®º(`is_hot`å­—æ®µ)
- âœ… æ”¯æŒç½®é¡¶è¯„è®ºè¯†åˆ«(`stick_position`å­—æ®µ)

### 3. åˆ†é¡µæœºåˆ¶
- ä½¿ç”¨æ¸¸æ ‡åˆ†é¡µï¼Œéå¸¸é«˜æ•ˆ
- é»˜è®¤æ¯é¡µ20æ¡è¯„è®º
- é€šè¿‡`cursor`å’Œ`has_more`æ§åˆ¶ç¿»é¡µ

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿åœ¨`.env.local`ä¸­é…ç½®ï¼š

```env
TIKHUB_API_KEY=your_api_key_here
TIKHUB_API_BASE_URL=https://api.tikhub.dev
```

### 2. APIé™æµ

- TikHub APIæœ‰è¯·æ±‚é¢‘ç‡é™åˆ¶
- å»ºè®®åœ¨æ‰¹é‡è¯·æ±‚æ—¶æ·»åŠ å»¶è¿Ÿï¼ˆ500-1000msï¼‰
- æ”¯æŒè‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š3æ¬¡ï¼‰

### 3. æ•°æ®æ—¶æ•ˆæ€§

- è¯„è®ºæ•°æ®å®æ—¶æ€§è¾ƒå¥½
- ç»Ÿè®¡æ•°æ®å¯èƒ½æœ‰å‡ å°æ—¶çš„å»¶è¿Ÿ
- å»ºè®®å®šæœŸæ›´æ–°æ•°æ®

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

### æ ¸å¿ƒæ–‡ä»¶
- `lib/tikhub/types.ts` - ç±»å‹å®šä¹‰
- `lib/tikhub/client.ts` - APIå®¢æˆ·ç«¯
- `lib/douyin/share-link.ts` - é“¾æ¥è§£æ

### æµ‹è¯•æ–‡ä»¶
- `tests/manual/test-douyin-comments.ts` - æµ‹è¯•è„šæœ¬
- `tests/manual/test-results-douyin-comments.md` - æœ¬æŠ¥å‘Š

### æ–‡æ¡£
- `OpenAPI Specification.md` - APIè§„èŒƒ
- `CLAUDE.md` - é¡¹ç›®æ¶æ„æ–‡æ¡£

---

## âœ¨ åç»­ä¼˜åŒ–å»ºè®®

### 1. é›†æˆåˆ°èŠå¤©ç³»ç»Ÿ
- åœ¨æŠ–éŸ³è§†é¢‘åˆ†ææ—¶è‡ªåŠ¨è·å–è¯„è®º
- å±•ç¤ºçƒ­é—¨è¯„è®ºå’Œç”¨æˆ·åé¦ˆ
- æä¾›è¯„è®ºæƒ…æ„Ÿåˆ†æ

### 2. æ•°æ®å­˜å‚¨
- å°†è¯„è®ºæ•°æ®å­˜å‚¨åˆ°æ•°æ®åº“
- æ”¯æŒå†å²æ•°æ®å¯¹æ¯”
- è¿½è¸ªè¯„è®ºå˜åŒ–è¶‹åŠ¿

### 3. å¯è§†åŒ–å±•ç¤º
- è¯„è®ºè¯äº‘å›¾
- æƒ…æ„Ÿåˆ†æå›¾è¡¨
- ç”¨æˆ·åœ°åŸŸåˆ†å¸ƒåœ°å›¾

### 4. æ™ºèƒ½åˆ†æ
- ä½¿ç”¨LLMåˆ†æè¯„è®ºå†…å®¹
- æå–ç”¨æˆ·å…³æ³¨ç‚¹
- ç”Ÿæˆè¥é”€æ´å¯ŸæŠ¥å‘Š

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

- **TikHub APIæ–‡æ¡£**: https://docs.tikhub.io
- **é¡¹ç›®æ¶æ„æ–‡æ¡£**: `CLAUDE.md`
- **æµ‹è¯•è„šæœ¬**: `tests/manual/test-douyin-comments.ts`

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-10-20
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡
**æ•°æ®æ¥æº**: TikHub API (https://api.tikhub.dev)
