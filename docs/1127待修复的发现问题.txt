现有跳转/加载卡顿和布局漂移主要来自（1）全客户端渲染 + 水合负荷大，（2）图片未优化，（3）移动端侧边栏水合后  状态反转导致抖动。可以通过少量改动改善体验。

  【关键洞察】

  - 数据结构：工作台首屏完全客户端，app/workspace/page.tsx 里的对话列表/聊天中心都在 CSR 后才拉数据，首跳白屏 + 二次
    渲染。
  - 复杂度：SmartChatCenter 全量挂载 + framer-motion 动画；pipeline-progress 也在客户端做动画。
  - 风险点：app/workspace/page.tsx 侧边栏初始 state 在 SSR 为 false，移动端水合后设为 true，引发布局跳变；
    next.config.mjs 关闭了 Next Image 优化，首屏资源大；缺少缓存策略导致每次导航都重新拉接口。

  【Linus式方案】

  1. 简化数据流：首页/文档页/登录页保持 RSC；工作台首屏提供最小 SSR 数据或骨架定高，避免白屏。
  2. 消除特殊情况：移动端侧栏初始折叠一致，去掉水合后的跳变。
  3. 笨但清晰：启用 Next Image 默认优化、给 API 加缓存头、合理 prefetch；动画只在必要时开。

  【具体改动建议（按优先级）】

  - app/workspace/page.tsx:30 侧栏初始值：useState(() => typeof window === 'undefined' ? true : window.innerWidth <
    768)，让 SSR 即以折叠渲染，避免移动端水合抖动；同时在容器上给 min-width 以锁定布局。
  - next.config.mjs：去掉 images: { unoptimized: true }，改回默认优化并配置 remotePatterns（如果有外链图）；这会显著减少    首屏图片体积并降低 CLS。
  - 首屏骨架定高：在工作台主区/侧栏骨架上设置固定高度或 min-height，避免骨架和实内容高度差导致跳动（components/
    skeletons/workspace-skeleton.tsx 以及聊天列表容器）。
  - 缓存/预取：对只读接口加 s-maxage/stale-while-revalidate 头（如对话列表、商家列表 API）；在 App Router 服务端使用
    fetch(..., { next: { revalidate: 30 } }) 返回初始数据注水，减少客户端首包请求。
  - 动画降噪：在列表型场景（聊天消息、pipeline steps）关闭 AnimatePresence/layout 当列表长度>阈值；framer-motion 仅保留
    小型过渡，降低主线程占用。
  - 资源体积：运行 next build --analyze，把重型依赖（framer-motion、recharts）改按需动态加载在使用页面，避免全局 bundle
    污染导航。
  - 字体与预连接：app/layout.tsx 当前仍 preconnect Google 字体但未使用，移除无用 preconnect，或改用 next/font 内联本地字    体，减少外链握手。

  【需要你确认/提供】

  1. 抖动主要出现在移动端进入 /workspace，还是桌面也有？
  2. Vercel Analytics/Speed Insights 是否有 TTFB/CLS 具体数值？
  3. 是否有外链图片域名，需要配置 images.remotePatterns？
  4. 是否可接受在 /workspace 上做轻量 SSR（返回最近 N 条对话）以减少首包请求？