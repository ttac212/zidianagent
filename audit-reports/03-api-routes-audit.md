# APIè·¯ç”±æ¨¡å—å®¡è®¡æŠ¥å‘Š

## æ¨¡å—æ¦‚è§ˆ

é¡¹ç›®åŒ…å«35ä¸ªç²¾å¿ƒç»„ç»‡çš„APIç«¯ç‚¹ï¼Œè¦†ç›–è®¤è¯ã€èŠå¤©ã€ç”¨æˆ·ç®¡ç†ã€å•†å®¶æ•°æ®ã€æ–‡æ¡£ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚é‡‡ç”¨Next.js App Routeræ¶æ„ï¼Œå®ç°äº†ç»Ÿä¸€çš„è®¤è¯ã€é”™è¯¯å¤„ç†å’Œæ•°æ®éªŒè¯æœºåˆ¶ã€‚

### APIè·¯ç”±ç»“æ„
```
app/api/
â”œâ”€â”€ auth/              # è®¤è¯ç›¸å…³ (signin, signout, session)
â”œâ”€â”€ admin/             # ç®¡ç†å‘˜åŠŸèƒ½ (stats, users, system)
â”œâ”€â”€ chat/              # èŠå¤©æ ¸å¿ƒAPI (æ”¯æŒSSEæµå¼å“åº”)
â”œâ”€â”€ conversations/     # å¯¹è¯ç®¡ç† (CRUD, export)
â”œâ”€â”€ merchants/         # å•†å®¶æ•°æ® (list, search, stats)
â”œâ”€â”€ users/             # ç”¨æˆ·ç®¡ç† (profile, usage, settings)
â”œâ”€â”€ documents/         # æ–‡æ¡£ç®¡ç† (upload, parse, delete)
â”œâ”€â”€ feedback/          # ç”¨æˆ·åé¦ˆç³»ç»Ÿ
â”œâ”€â”€ health/            # å¥åº·æ£€æŸ¥å’Œç›‘æ§
â””â”€â”€ keyword-data/      # å…³é”®å­—æ•°æ®åˆ†æ
```

## å®‰å…¨æ€§å®¡è®¡

### âœ… ä¼˜åŠ¿

#### 1. è®¤è¯æœºåˆ¶
- **ç»Ÿä¸€è®¤è¯**: æ‰€æœ‰å—ä¿æŠ¤ç«¯ç‚¹ä½¿ç”¨ `getToken()` éªŒè¯
- **æƒé™æ§åˆ¶**: ç®¡ç†å‘˜ç«¯ç‚¹å¼ºåˆ¶éªŒè¯ `role === 'ADMIN'`
- **ç”¨æˆ·éš”ç¦»**: ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- **TokenéªŒè¯**: ä»JWT tokenè·å–ç”¨æˆ·IDï¼Œä¸ä¿¡ä»»è¯·æ±‚ä½“

#### 2. è¾“å…¥éªŒè¯
- **å‚æ•°éªŒè¯**: å¿…å¡«å­—æ®µæ£€æŸ¥å’Œæ ¼å¼éªŒè¯
- **é‚®ç®±éªŒè¯**: ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼éªŒè¯é‚®ç®±æ ¼å¼
- **é‚€è¯·ç éªŒè¯**: 6-20ä½å­—æ¯æ•°å­—æ ¼å¼éªŒè¯
- **æ•°æ®ç±»å‹**: ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥å’Œè½¬æ¢

#### 3. é”™è¯¯å¤„ç†
- **ç»Ÿä¸€å“åº”**: ä¸€è‡´çš„é”™è¯¯å“åº”æ ¼å¼
- **çŠ¶æ€ç **: æ­£ç¡®çš„HTTPçŠ¶æ€ç ä½¿ç”¨
- **é”™è¯¯åˆ†ç±»**: åŒºåˆ†è®¤è¯ã€æƒé™ã€éªŒè¯å’ŒæœåŠ¡å™¨é”™è¯¯

### âš ï¸ å®‰å…¨é£é™©

#### 1. é«˜é£é™©é—®é¢˜

**1.1 è°ƒè¯•ç«¯ç‚¹æš´éœ²æ•æ„Ÿä¿¡æ¯**
```typescript
// app/api/auth/me/route.ts:19-37
return NextResponse.json({
  authenticated: true,
  token: {
    sub: token.sub,
    email: token.email,
    // æš´éœ²å®Œæ•´tokenå†…å®¹
  }
})
```
- **é£é™©**: ç”Ÿäº§ç¯å¢ƒæš´éœ²JWT tokenå®Œæ•´å†…å®¹
- **å½±å“**: æ•æ„Ÿä¿¡æ¯æ³„éœ²ï¼Œå¯èƒ½è¢«æ¶æ„åˆ©ç”¨
- **å»ºè®®**: ç”Ÿäº§ç¯å¢ƒç¦ç”¨æˆ–é™åˆ¶è¿”å›å†…å®¹

**1.2 ç®¡ç†å‘˜APIä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®**
```typescript
// app/api/admin/users/route.ts:16-17
// æ¨¡æ‹Ÿç”¨æˆ·æ•°æ® - å®é™…é¡¹ç›®ä¸­è¿™é‡Œä¼šä»æ•°æ®åº“è·å–
const users = generateMockUsers()
```
- **é£é™©**: ç®¡ç†å‘˜åŠŸèƒ½ä½¿ç”¨å‡æ•°æ®
- **å½±å“**: ç®¡ç†åŠŸèƒ½ä¸å¯ç”¨ï¼Œå¯èƒ½è¯¯å¯¼ç®¡ç†å‘˜
- **å»ºè®®**: å®ç°çœŸå®çš„æ•°æ®åº“æŸ¥è¯¢

#### 2. ä¸­ç­‰é£é™©é—®é¢˜

**2.1 é”™è¯¯ä¿¡æ¯è¿‡äºè¯¦ç»†**
```typescript
// å¤šä¸ªAPIç«¯ç‚¹è¿”å›è¯¦ç»†çš„æ•°æ®åº“é”™è¯¯
catch (error) {
  return NextResponse.json({ error: error.message }, { status: 500 })
}
```
- **é£é™©**: å¯èƒ½æ³„éœ²æ•°æ®åº“ç»“æ„ä¿¡æ¯
- **å½±å“**: ä¸ºæ”»å‡»è€…æä¾›ç³»ç»Ÿä¿¡æ¯
- **å»ºè®®**: ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é€šç”¨é”™è¯¯æ¶ˆæ¯

**2.2 ç¼ºä¹é€Ÿç‡é™åˆ¶**
- **é£é™©**: æ²¡æœ‰APIè°ƒç”¨é¢‘ç‡é™åˆ¶
- **å½±å“**: å¯èƒ½è¢«æ¶æ„åˆ·é‡æ”»å‡»
- **å»ºè®®**: å®ç°åŸºäºIPæˆ–ç”¨æˆ·çš„é€Ÿç‡é™åˆ¶

#### 3. ä½é£é™©é—®é¢˜

**3.1 CORSé…ç½®ç¼ºå¤±**
- **é£é™©**: æ²¡æœ‰æ˜ç¡®çš„è·¨åŸŸç­–ç•¥
- **å½±å“**: å¯èƒ½çš„è·¨åŸŸå®‰å…¨é—®é¢˜
- **å»ºè®®**: é…ç½®æ˜ç¡®çš„CORSç­–ç•¥

## ä»£ç è´¨é‡å®¡è®¡

### âœ… ä¼˜åŠ¿

#### 1. æ¶æ„è®¾è®¡
- **æ¨¡å—åŒ–**: æ¸…æ™°çš„åŠŸèƒ½æ¨¡å—åˆ’åˆ†
- **ä¸€è‡´æ€§**: ç»Ÿä¸€çš„APIè®¾è®¡æ¨¡å¼
- **ç±»å‹å®‰å…¨**: å®Œæ•´çš„TypeScriptç±»å‹å®šä¹‰
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„é”™è¯¯å¤„ç†æœºåˆ¶

#### 2. æ€§èƒ½ä¼˜åŒ–
- **åˆ†é¡µæ”¯æŒ**: åˆ—è¡¨APIæ”¯æŒåˆ†é¡µæŸ¥è¯¢
- **é€‰æ‹©æ€§æŸ¥è¯¢**: ä½¿ç”¨Prisma selectä¼˜åŒ–æŸ¥è¯¢
- **ç¼“å­˜æ§åˆ¶**: å¥åº·æ£€æŸ¥APIè®¾ç½®æ­£ç¡®çš„ç¼“å­˜å¤´
- **æµå¼å“åº”**: èŠå¤©APIæ”¯æŒSSEæµå¼å“åº”

#### 3. å¯ç»´æŠ¤æ€§
- **æ¸…æ™°å‘½å**: å‡½æ•°å’Œå˜é‡å‘½åæ¸…æ™°
- **æ³¨é‡Šæ–‡æ¡£**: å…³é”®åŠŸèƒ½æœ‰è¯¦ç»†æ³¨é‡Š
- **é”™è¯¯åˆ†ç±»**: è‡ªå®šä¹‰é”™è¯¯ç±»å‹å’Œå¤„ç†

### âš ï¸ æ”¹è¿›å»ºè®®

#### 1. é”™è¯¯å¤„ç†æ ‡å‡†åŒ–
```typescript
// å½“å‰: ä¸ä¸€è‡´çš„é”™è¯¯å¤„ç†
catch (error) {
  return NextResponse.json({ error: error.message }, { status: 500 })
}

// å»ºè®®: ç»Ÿä¸€é”™è¯¯å¤„ç†
catch (error) {
  const apiError = handleAPIError(error)
  return NextResponse.json({ 
    error: apiError.message,
    code: apiError.code 
  }, { status: apiError.statusCode })
}
```

#### 2. è¾“å…¥éªŒè¯å¢å¼º
```typescript
// å½“å‰: åŸºç¡€éªŒè¯
if (!email) {
  return NextResponse.json({ error: 'é‚®ç®±æ˜¯å¿…å¡«é¡¹' }, { status: 400 })
}

// å»ºè®®: ä½¿ç”¨éªŒè¯åº“
const validation = validateInput(body, userSchema)
if (!validation.isValid) {
  return NextResponse.json({ 
    error: 'Validation failed',
    details: validation.errors 
  }, { status: 400 })
}
```

#### 3. æ—¥å¿—è®°å½•
```typescript
// å»ºè®®: æ·»åŠ ç»“æ„åŒ–æ—¥å¿—
import { logger } from '@/lib/logger'

export async function POST(request: NextRequest) {
  const startTime = Date.now()
  try {
    // APIé€»è¾‘
    logger.info('API request completed', {
      endpoint: '/api/users',
      method: 'POST',
      duration: Date.now() - startTime,
      userId: token.sub
    })
  } catch (error) {
    logger.error('API request failed', {
      endpoint: '/api/users',
      method: 'POST',
      error: error.message,
      userId: token.sub
    })
  }
}
```

## æ¶æ„ä¸€è‡´æ€§å®¡è®¡

### âœ… ç¬¦åˆæ ‡å‡†

1. **å“åº”æ ¼å¼**: å¤§éƒ¨åˆ†APIä½¿ç”¨ä¸€è‡´çš„å“åº”æ ¼å¼
2. **è®¤è¯æ¨¡å¼**: ç»Ÿä¸€ä½¿ç”¨NextAuth JWTè®¤è¯
3. **é”™è¯¯çŠ¶æ€ç **: æ­£ç¡®ä½¿ç”¨HTTPçŠ¶æ€ç 
4. **RESTfulè®¾è®¡**: éµå¾ªREST APIè®¾è®¡åŸåˆ™

### âš ï¸ ä¸ä¸€è‡´é—®é¢˜

#### 1. å“åº”æ ¼å¼ä¸ç»Ÿä¸€
```typescript
// æœ‰äº›APIè¿”å›
{ success: true, data: {...} }

// æœ‰äº›APIç›´æ¥è¿”å›æ•°æ®
{ users: [...], total: 100 }

// å»ºè®®: ç»Ÿä¸€å“åº”æ ¼å¼
interface APIResponse<T> {
  success: boolean
  data?: T
  error?: string
  meta?: {
    page?: number
    limit?: number
    total?: number
  }
}
```

#### 2. é”™è¯¯å¤„ç†ä¸ä¸€è‡´
- æœ‰äº›ä½¿ç”¨ `Response.json()`
- æœ‰äº›ä½¿ç”¨ `NextResponse.json()`
- å»ºè®®ç»Ÿä¸€ä½¿ç”¨ `NextResponse.json()`

## æ€§èƒ½å®¡è®¡

### âœ… ä¼˜åŠ¿

1. **æ•°æ®åº“ä¼˜åŒ–**: ä½¿ç”¨Prisma selectå‡å°‘æ•°æ®ä¼ è¾“
2. **åˆ†é¡µæŸ¥è¯¢**: é¿å…å¤§é‡æ•°æ®ä¸€æ¬¡æ€§åŠ è½½
3. **ç´¢å¼•ä½¿ç”¨**: æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨é€‚å½“çš„ç´¢å¼•
4. **ç¼“å­˜ç­–ç•¥**: å¥åº·æ£€æŸ¥APIè®¾ç½®ç¼“å­˜æ§åˆ¶

### âš ï¸ æ€§èƒ½é—®é¢˜

1. **N+1æŸ¥è¯¢**: æŸäº›å…³è”æŸ¥è¯¢å¯èƒ½å­˜åœ¨N+1é—®é¢˜
2. **ç¼ºä¹ç¼“å­˜**: é¢‘ç¹æŸ¥è¯¢çš„æ•°æ®æ²¡æœ‰ç¼“å­˜
3. **å¤§æ•°æ®å¯¼å‡º**: å•†å®¶æ•°æ®å¯¼å‡ºå¯èƒ½å†…å­˜æº¢å‡º

## å…³é”®æ–‡ä»¶è¯„ä¼°

### ğŸ”´ é«˜é£é™©æ–‡ä»¶
- `app/api/auth/me/route.ts` - æš´éœ²æ•æ„Ÿè°ƒè¯•ä¿¡æ¯
- `app/api/admin/users/route.ts` - ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®

### ğŸŸ¡ ä¸­é£é™©æ–‡ä»¶
- `app/api/chat/route.ts` - æ ¸å¿ƒèŠå¤©åŠŸèƒ½ï¼Œéœ€è¦åŠ å¼ºç›‘æ§
- `app/api/users/[id]/route.ts` - ç”¨æˆ·æ•°æ®è®¿é—®æ§åˆ¶

### ğŸŸ¢ ä½é£é™©æ–‡ä»¶
- `app/api/health/route.ts` - å¥åº·æ£€æŸ¥ï¼Œè®¾è®¡è‰¯å¥½
- `app/api/conversations/route.ts` - å¯¹è¯ç®¡ç†ï¼Œå®‰å…¨æ€§è¾ƒå¥½

## ä¼˜å…ˆçº§æ”¹è¿›å»ºè®®

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (ç«‹å³ä¿®å¤)
1. **ç§»é™¤è°ƒè¯•ç«¯ç‚¹**: ç”Ÿäº§ç¯å¢ƒç¦ç”¨ `/api/auth/me`
2. **å®ç°çœŸå®ç®¡ç†API**: æ›¿æ¢æ¨¡æ‹Ÿæ•°æ®ä¸ºçœŸå®æ•°æ®åº“æŸ¥è¯¢
3. **ç»Ÿä¸€é”™è¯¯å¤„ç†**: å®ç°å…¨å±€é”™è¯¯å¤„ç†ä¸­é—´ä»¶

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (è¿‘æœŸä¿®å¤)
1. **æ·»åŠ é€Ÿç‡é™åˆ¶**: å®ç°APIè°ƒç”¨é¢‘ç‡æ§åˆ¶
2. **å¢å¼ºè¾“å…¥éªŒè¯**: ä½¿ç”¨éªŒè¯åº“æ ‡å‡†åŒ–è¾“å…¥éªŒè¯
3. **æ”¹è¿›æ—¥å¿—è®°å½•**: æ·»åŠ ç»“æ„åŒ–æ—¥å¿—å’Œç›‘æ§

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (é•¿æœŸä¼˜åŒ–)
1. **æ€§èƒ½ä¼˜åŒ–**: æ·»åŠ ç¼“å­˜å±‚å’ŒæŸ¥è¯¢ä¼˜åŒ–
2. **APIæ–‡æ¡£**: ç”ŸæˆOpenAPIæ–‡æ¡£
3. **æµ‹è¯•è¦†ç›–**: å¢åŠ APIç«¯ç‚¹çš„å•å…ƒæµ‹è¯•

## ğŸ” æ ¸å¿ƒAPIæ·±åº¦åˆ†æ

### èŠå¤©API (`/api/chat`) â­â­â­â­â­

#### âœ… ä¼˜ç§€è®¾è®¡
```typescript
// å¤šKEYæ¶æ„ç®¡ç† - è‡ªåŠ¨é€‰æ‹©æœ€åˆé€‚çš„API Key
const keySelection = selectApiKey(useModel)
if (!keySelection.apiKey) {
  const errorMsg = keySelection.keySource === 'none' 
    ? `æœªé…ç½®æ¨¡å‹ ${useModel} å¯¹åº”çš„API Key` 
    : "åç«¯API Keyé…ç½®é”™è¯¯"
  return new Response(JSON.stringify({ 
    error: errorMsg, modelId: useModel,
    suggestion: `è¯·é…ç½® ${useModel} å¯¹åº”ä¾›åº”å•†çš„API Key`
  }), { status: 500 })
}
```

**æŠ€æœ¯äº®ç‚¹**:
- **æµå¼å“åº”å¤„ç†**: å®Œæ•´çš„SSEæµå¤„ç†å’ŒTokenç»Ÿè®¡
- **åŒé‡æ•°æ®è®°å½•**: å®æ—¶æ›´æ–°Userè¡¨å’ŒUsageStatsè¡¨
- **å¼‚æ­¥ä¿å­˜**: ä¸é˜»å¡ç”¨æˆ·å“åº”çš„å¼‚æ­¥æ•°æ®æŒä¹…åŒ–
- **å®¹é”™æœºåˆ¶**: è‡ªåŠ¨åˆ›å»ºå¯¹è¯IDï¼Œä¿éšœåç»­ç»Ÿè®¡è®°å½•
- **é…é¢æ£€æŸ¥**: å®æ—¶æ£€æŸ¥ç”¨æˆ·æœˆåº¦Tokené™åˆ¶

#### âš ï¸ å‘ç°çš„é—®é¢˜
```typescript
// ç¬¬284-290è¡Œï¼šflush()å‡½æ•°ä¸­çš„å¼‚æ­¥è°ƒç”¨ç¼ºä¹é”™è¯¯å¤„ç†
flush() {
  if (userId && assistantContent && isComplete) {
    saveAssistantMessage() // ç¼ºä¹awaitå’Œé”™è¯¯å¤„ç†
  }
}
```

### å¥åº·æ£€æŸ¥API (`/api/health`) â­â­â­â­â­

#### âœ… ä¼ä¸šçº§è®¾è®¡
```typescript
// è½»é‡çº§æ£€æŸ¥é¿å…æ•°æ®åº“è¿æ¥æ± æ¶ˆè€—
const memoryThreshold = 2 * 1024 * 1024 * 1024; // 2GB
const memoryHealthy = memoryUsage.heapUsed < memoryThreshold;

// åŠŸèƒ½å¼€å…³æ”¯æŒ
const monitoringEnabled = process.env.NEXT_PUBLIC_CONNECTION_MONITORING;
if (monitoringEnabled === 'disabled') {
  return NextResponse.json({...}, { status: 503 });
}
```

**è®¾è®¡äº®ç‚¹**:
- **å¤šæ¨¡å¼æ”¯æŒ**: disabled/enabled/debugä¸‰ç§æ¨¡å¼
- **æ€§èƒ½ä¼˜å…ˆ**: é¿å…æ•°æ®åº“è¿æ¥ï¼Œä»…æ£€æŸ¥è¿›ç¨‹å’Œå†…å­˜
- **HTTPæ–¹æ³•å®Œæ•´**: æ”¯æŒGETã€HEADå’Œæ­£ç¡®çš„405é”™è¯¯
- **ç¼“å­˜æ§åˆ¶**: æ­£ç¡®çš„no-cacheå¤´éƒ¨è®¾ç½®

### ç”¨æˆ·ç®¡ç†API (`/api/users`) â­â­â­â­

#### âœ… æ ‡å‡†RESTfulè®¾è®¡
```typescript
// åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–
const skip = (page - 1) * limit
const users = await prisma.user.findMany({
  where, select: {
    // ç²¾ç¡®æ§åˆ¶è¿”å›å­—æ®µï¼Œå‡å°‘æ•°æ®ä¼ è¾“
    id: true, email: true, username: true,
    _count: { select: { conversations: true, documents: true } }
  },
  orderBy: { createdAt: 'desc' }, skip, take: limit,
})
```

**ä¼˜åŒ–ç‰¹ç‚¹**:
- **æ•°æ®æƒé™æ§åˆ¶**: ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„æ•°æ®
- **æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨selectå‡å°‘æ•°æ®ä¼ è¾“é‡
- **é‡å¤æ£€æŸ¥**: é‚®ç®±å’Œç”¨æˆ·åå”¯ä¸€æ€§éªŒè¯

### å¯¹è¯API (`/api/conversations`) â­â­â­â­

#### âœ… å®‰å…¨çš„æ•°æ®è®¿é—®
```typescript
// ä¸¥æ ¼çš„ç”¨æˆ·æƒé™æ£€æŸ¥
const conversations = await prisma.conversation.findMany({
  where: {
    userId, // ä»JWT tokenè·å–ï¼Œä¸ä¿¡ä»»è¯·æ±‚å‚æ•°
    user: { status: { not: 'DELETED' } }
  },
  orderBy: [
    { lastMessageAt: 'desc' },
    { updatedAt: 'desc' }
  ],
})
```

## ğŸ›¡ï¸ å®‰å…¨æ¶æ„è¯„ä¼°æ›´æ–°

### æ–°å‘ç°çš„å®‰å…¨ä¼˜åŠ¿
1. **JWT TokenéªŒè¯**: æ‰€æœ‰APIç»Ÿä¸€ä½¿ç”¨getToken()ä»JWTè·å–ç”¨æˆ·ID
2. **æ•°æ®æƒé™éš”ç¦»**: ä¸¥æ ¼çš„ç”¨æˆ·æ•°æ®è®¿é—®æ§åˆ¶ï¼Œé˜²æ­¢è¶Šæƒè®¿é—®
3. **æ¨¡å‹ç™½åå•**: èŠå¤©APIå®æ–½æ¨¡å‹éªŒè¯å’Œç™½åå•æœºåˆ¶
4. **é…é¢ç®¡ç†**: å®æ—¶Tokenä½¿ç”¨é‡æ£€æŸ¥å’Œé™åˆ¶

### æ–°å‘ç°çš„å®‰å…¨é£é™©

#### ğŸ”´ å¼‚æ­¥æ•°æ®ä¸€è‡´æ€§é£é™©
```typescript
// app/api/chat/route.ts:284-290
// å¼‚æ­¥ä¿å­˜å¯èƒ½å¤±è´¥ä½†ä¸ä¼šé€šçŸ¥ç”¨æˆ·
flush() {
  if (userId && assistantContent && isComplete) {
    saveAssistantMessage() // æ— é”™è¯¯å¤„ç†
  }
}
```
**é£é™©**: ç”¨æˆ·ä»¥ä¸ºå¯¹è¯å·²ä¿å­˜ï¼Œä½†å®é™…ä¿å­˜å¤±è´¥
**å»ºè®®**: æ·»åŠ ä¿å­˜çŠ¶æ€æ£€æŸ¥å’Œç”¨æˆ·é€šçŸ¥æœºåˆ¶

#### ğŸŸ¡ SQLæ³¨å…¥é¢„é˜²
```typescript
// Prisma ORMæœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥ï¼Œä½†éœ€è¦æ³¨æ„rawæŸ¥è¯¢
const users = await prisma.user.findMany({ where: { email: { contains: search } } })
```
**ä¼˜åŠ¿**: ä½¿ç”¨Prisma ORMå‚æ•°åŒ–æŸ¥è¯¢ï¼Œæœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥

## ğŸ“Š æ›´æ–°åè¯„åˆ†

- **å®‰å…¨æ€§**: 8.5/10 (JWTè®¤è¯å®Œå–„ï¼Œå­˜åœ¨å¼‚æ­¥æ•°æ®é£é™©)
- **ä»£ç è´¨é‡**: 9/10 (ä¼ä¸šçº§ä»£ç ç»“æ„ï¼ŒæŠ€æœ¯å®ç°ä¼˜ç§€)
- **æ¶æ„ä¸€è‡´æ€§**: 8.5/10 (æ•´ä½“ä¸€è‡´ï¼Œå°‘æ•°å“åº”æ ¼å¼éœ€ç»Ÿä¸€)
- **æ€§èƒ½**: 9/10 (æŸ¥è¯¢ä¼˜åŒ–ã€æµå¼å¤„ç†ã€ç¼“å­˜æ§åˆ¶å®Œå¤‡)
- **å¯ç»´æŠ¤æ€§**: 9/10 (æ¨¡å—åŒ–ä¼˜ç§€ï¼Œé”™è¯¯å¤„ç†å®Œæ•´)
- **æŠ€æœ¯åˆ›æ–°**: 9.5/10 (å¤šKEYç®¡ç†ã€æµå¼å¤„ç†ã€å¼‚æ­¥ç»Ÿè®¡è®¾è®¡å…ˆè¿›)

---
*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-01-03*
*å®¡è®¡èŒƒå›´: APIè·¯ç”±æ¨¡å—*
