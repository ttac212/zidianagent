# TikHub API è§†é¢‘çƒ­æ¦œæµ‹è¯•å·¥å…·

## åŠŸèƒ½è¯´æ˜

è¿™ä¸ªæµ‹è¯•å·¥å…·ç”¨äºæµ‹è¯• TikHub API çš„è§†é¢‘çƒ­æ¦œæ¥å£ï¼Œè·å–æŠ–éŸ³å„å‚ç±»çš„çƒ­é—¨è§†é¢‘æ’è¡Œæ¦œã€‚

### API ä¿¡æ¯
- **ç«¯ç‚¹**: `/api/v1/douyin/billboard/fetch_hot_total_video_list`
- **æ–¹æ³•**: POST
- **è®¤è¯**: Bearer Token (ä½¿ç”¨ `TIKHUB_API_KEY`)
- **å‚æ•°**:
  - `page`: é¡µç ï¼Œé»˜è®¤1
  - `page_size`: æ¯é¡µæ•°é‡ï¼Œé»˜è®¤10
  - `date_window`: æ—¶é—´çª—å£ï¼Œ1æŒ‰å°æ—¶ 2æŒ‰å¤©ï¼Œé»˜è®¤24
  - `tags`: å­çº§å‚ç±»æ ‡ç­¾ï¼Œç©ºåˆ™ä¸ºå…¨éƒ¨
- **è¿”å›**: è§†é¢‘çƒ­æ¦œåˆ—è¡¨ï¼ˆæŒ‰çƒ­åº¦æ’åºï¼‰

## ä½¿ç”¨æ–¹æ³•

### 1. åŸºæœ¬ä½¿ç”¨ - è·å–å…¨éƒ¨å‚ç±»è§†é¢‘çƒ­æ¦œ

```bash
npx tsx scripts/test-hot-video-list.ts
```

**è¾“å‡ºå†…å®¹åŒ…æ‹¬**:
- è§†é¢‘æ ‡é¢˜
- ä½œè€…æ˜µç§°
- æ’­æ”¾æ•°ã€ç‚¹èµæ•°ã€ç²‰ä¸æ•°ã€å…³æ³¨æ•°
- çƒ­åº¦å€¼
- å‘å¸ƒæ—¶é—´
- è§†é¢‘ID
- å®Œæ•´æ•°æ®å¯¼å‡ºåˆ° JSON æ–‡ä»¶

### 2. è·å–ç‰¹å®šå‚ç±»çš„è§†é¢‘çƒ­æ¦œ

```bash
# ç¾é£Ÿå‚ç±»
npx tsx scripts/test-hot-video-list.ts --tag=628

# æ—…è¡Œå‚ç±»
npx tsx scripts/test-hot-video-list.ts --tag=629

# æ•™è‚²æ ¡å›­å‚ç±»
npx tsx scripts/test-hot-video-list.ts --tag=626
```

### 3. è‡ªå®šä¹‰å‚æ•°

```bash
# æŸ¥è¯¢æŒ‰å°æ—¶çª—å£çš„æ•°æ®ï¼Œæ¯é¡µ20æ¡
npx tsx scripts/test-hot-video-list.ts --window=1 --size=20

# ç¾é£Ÿå‚ç±»ï¼ŒæŒ‰å¤©çª—å£ï¼Œ5æ¡æ•°æ®
npx tsx scripts/test-hot-video-list.ts --tag=628 --window=24 --size=5
```

## è¯·æ±‚å‚æ•°ç»“æ„

### å…¨éƒ¨å‚ç±»æŸ¥è¯¢
```json
{
  "page": 1,
  "page_size": 10,
  "date_window": 24,
  "tags": []
}
```

### å•ä¸ªå‚ç±»æŸ¥è¯¢ï¼ˆå¦‚ç¾é£Ÿï¼‰
```json
{
  "page": 1,
  "page_size": 10,
  "date_window": 24,
  "tags": [
    { "value": 628 }
  ]
}
```

### å‚ç±»+å­å‚ç±»æŸ¥è¯¢
```json
{
  "page": 1,
  "page_size": 10,
  "date_window": 24,
  "tags": [
    {
      "value": 628,
      "children": [
        { "value": 62804 },
        { "value": 62803 }
      ]
    }
  ]
}
```

## å“åº”æ•°æ®ç»“æ„

### è§†é¢‘å¯¹è±¡
```typescript
interface HotVideoInfo {
  item_id: string              // è§†é¢‘ID
  item_title: string           // è§†é¢‘æ ‡é¢˜
  item_cover_url: string       // å°é¢URL
  item_duration: number        // è§†é¢‘æ—¶é•¿(æ¯«ç§’)
  nick_name: string            // ä½œè€…æ˜µç§°
  avatar_url: string           // ä½œè€…å¤´åƒURL
  fans_cnt: number             // ç²‰ä¸æ•°
  play_cnt: number             // æ’­æ”¾æ•°
  publish_time: number         // å‘å¸ƒæ—¶é—´æˆ³
  score: number                // çƒ­åº¦å€¼
  item_url: string             // è§†é¢‘URL
  like_cnt: number             // ç‚¹èµæ•°
  follow_cnt: number           // å…³æ³¨æ•°
  follow_rate: number          // å…³æ³¨ç‡
  like_rate: number            // ç‚¹èµç‡
  media_type: number           // åª’ä½“ç±»å‹
  rank?: number                // æ’å
}
```

### ç¤ºä¾‹å“åº”
```json
{
  "code": 0,
  "data": {
    "page": {
      "page": 1,
      "page_size": 5,
      "total": 1000
    },
    "objs": [
      {
        "item_id": "7572586014012717994",
        "item_title": "ä»–å®¶çœŸé è°± è¿‡ä¸ªçºªå¿µæ—¥ç”·æœ‹å‹çš„å¤´å‘è¢«ç«çƒ§äº†ã€‚",
        "nick_name": "Yaooo.",
        "play_cnt": 111227583,
        "like_cnt": 1841015,
        "fans_cnt": 12824,
        "score": 4155846,
        "publish_time": 1763130079
      }
    ]
  }
}
```

## å‰ç½®æ¡ä»¶

### 1. ç¯å¢ƒå˜é‡é…ç½®

ç¡®ä¿ `.env.local` æ–‡ä»¶ä¸­é…ç½®äº†ä»¥ä¸‹å˜é‡:

```env
# TikHub API é…ç½®
TIKHUB_API_BASE_URL=https://api.tikhub.io
TIKHUB_API_KEY=your_tikhub_api_key_here
```

### 2. è·å– API Key

1. è®¿é—® [TikHub ç”¨æˆ·ä¸­å¿ƒ](https://user.tikhub.io)
2. æ³¨å†Œå¹¶ç™»å½•è´¦æˆ·
3. åœ¨ç”¨æˆ·ä¸­å¿ƒåˆ›å»º API Token
4. å¤åˆ¶ API Key å¹¶é…ç½®åˆ° `.env.local` æ–‡ä»¶

### 3. ç¡®è®¤ä¾èµ–å®‰è£…

```bash
pnpm install
```

## è¾“å‡ºç¤ºä¾‹

### å…¨éƒ¨å‚ç±»è§†é¢‘çƒ­æ¦œ

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     TikHub API - è§†é¢‘çƒ­æ¦œæµ‹è¯•å·¥å…·                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

=== æµ‹è¯•è·å–è§†é¢‘çƒ­æ¦œåˆ—è¡¨ï¼ˆå…¨éƒ¨å‚ç±»ï¼‰===

æŸ¥è¯¢å‚æ•°:
  æ—¶é—´çª—å£: æŒ‰å¤©
  æ¯é¡µæ•°é‡: 5
  å‚ç±»ç­›é€‰: å…¨éƒ¨

æ­£åœ¨è·å–è§†é¢‘çƒ­æ¦œ...

âœ… æˆåŠŸè·å–è§†é¢‘çƒ­æ¦œ
æœ¬é¡µæ•°é‡: 5
æ€»æ•°: 1000
æœ‰æ›´å¤šæ•°æ®: æ˜¯

=== çƒ­é—¨è§†é¢‘åˆ—è¡¨ ===

1. ä»–å®¶ğŸ‘ŸçœŸé è°±ğŸ‘‰@æ½®é‹èšå‹ï¼ˆğŸ‰æ¡£å£ï¼‰ è¿‡ä¸ªçºªå¿µæ—¥ç”·æœ‹å‹çš„å¤´å‘è¢«ç«çƒ§äº†ã€‚
   ä½œè€…: Yaooo.
   æ’­æ”¾: 1.1äº¿
   ç‚¹èµ: 184.1ä¸‡
   ç²‰ä¸: 1.3ä¸‡
   å…³æ³¨: 1.5ä¸‡
   çƒ­åº¦å€¼: 4155846
   å‘å¸ƒæ—¶é—´: 2å¤©å‰
   è§†é¢‘ID: 7572586014012717994

ğŸ“„ å®Œæ•´æ•°æ®å·²ä¿å­˜åˆ°: ./hot-video-list-output.json
```

### ç‰¹å®šå‚ç±»è§†é¢‘çƒ­æ¦œ

```
=== æµ‹è¯•è·å–è§†é¢‘çƒ­æ¦œåˆ—è¡¨ï¼ˆç¾é£Ÿå‚ç±»ï¼‰===

æŸ¥è¯¢å‚æ•°:
  æ—¶é—´çª—å£: æŒ‰å¤©
  æ¯é¡µæ•°é‡: 5
  å‚ç±»ç­›é€‰: ç¾é£Ÿ (ID: 628)

æ­£åœ¨è·å–è§†é¢‘çƒ­æ¦œ...

âœ… æˆåŠŸè·å–è§†é¢‘çƒ­æ¦œ
æœ¬é¡µæ•°é‡: 5
æ€»æ•°: 1000
æœ‰æ›´å¤šæ•°æ®: æ˜¯

=== ç¾é£Ÿå‚ç±» - çƒ­é—¨è§†é¢‘åˆ—è¡¨ ===

1. å¸¦å…¥è–¯é¥¼è§†è§’belikeï¼šäººåœ¨å·¥ä½ï¼Œæ˜æ˜æ¬²ç¢
   ä½œè€…: éº¦å½“åŠ³
   æ’­æ”¾: 626.6ä¸‡
   ç‚¹èµ: 30.8ä¸‡
   ç²‰ä¸: 231.4ä¸‡
   å…³æ³¨: 1.2ä¸‡
   çƒ­åº¦å€¼: 825787
   å‘å¸ƒæ—¶é—´: 2å¤©å‰

ğŸ“„ å®Œæ•´æ•°æ®å·²ä¿å­˜åˆ°: ./hot-video-list-628-output.json
```

## è¾“å‡ºæ–‡ä»¶

æµ‹è¯•å·¥å…·ä¼šè‡ªåŠ¨ç”ŸæˆJSONæ–‡ä»¶:

### å…¨éƒ¨å‚ç±»
`hot-video-list-output.json`:
```json
{
  "queryParams": {
    "dateWindow": 24,
    "pageSize": 10,
    "category": "å…¨éƒ¨"
  },
  "total": 1000,
  "count": 10,
  "hasMore": true,
  "data": {
    "code": 0,
    "data": {
      "page": {...},
      "objs": [...]
    }
  }
}
```

### ç‰¹å®šå‚ç±»
`hot-video-list-{tagId}-output.json`:
```json
{
  "queryParams": {
    "dateWindow": 24,
    "pageSize": 5,
    "category": "ç¾é£Ÿ",
    "tagId": 628
  },
  "total": 1000,
  "count": 5,
  "hasMore": true,
  "data": {...}
}
```

## å¸¸è§å‚ç±»æ ‡ç­¾ID

| å‚ç±» | ID | å­å‚ç±»ç¤ºä¾‹ |
|------|----|----|
| ç¾é£Ÿ | 628 | å“é…’æ•™å­¦(62808), ç¾é£Ÿæ•™ç¨‹(62804) |
| æ—…è¡Œ | 629 | æ—…è¡Œé£æ™¯(62905), æ—…è¡Œè®°å½•(62913) |
| ä¼‘é—²å¨±ä¹ | 634 | é€›è¡—, ç°åœºæ¼”å‡º, è¿åŠ¨ç©ä¹ |
| æ–‡åŒ– | 624 | ä¼ ç»Ÿæ–‡åŒ–, æ­¦æœ¯, äººæ–‡ |
| èˆè¹ˆ | 612 | èŠ­è•¾èˆ, æ‰‹åŠ¿èˆ, èˆè¹ˆæ•™å­¦ |
| æ•™è‚²æ ¡å›­ | 626 | é«˜è€ƒ, å‡ºå›½ç•™å­¦, è‰ºè€ƒ |
| æ±½è½¦ | 635 | è½¦è¾†ç±»å‹, ç”¨è½¦, æ–°è½¦ |

è·å–å®Œæ•´æ ‡ç­¾åˆ—è¡¨:
```bash
npx tsx scripts/test-content-tags.ts
```

## åº”ç”¨åœºæ™¯

### 1. å†…å®¹è¶‹åŠ¿åˆ†æ
- å‘ç°å½“å‰çƒ­é—¨çš„å†…å®¹ç±»å‹
- åˆ†æçˆ†æ¬¾è§†é¢‘çš„ç‰¹å¾
- ç ”ç©¶ä¸åŒå‚ç±»çš„å†…å®¹è¶‹åŠ¿

### 2. åˆ›ä½œçµæ„Ÿ
- é€šè¿‡çƒ­æ¦œå‘ç°åˆ›ä½œæ–¹å‘
- å­¦ä¹ çƒ­é—¨å†…å®¹çš„åˆ›ä½œæ‰‹æ³•
- ä¼˜åŒ–å†…å®¹é€‰é¢˜ç­–ç•¥

### 3. ç«å“åˆ†æ
- ç ”ç©¶åŒå‚ç±»çƒ­é—¨å†…å®¹
- åˆ†ææˆåŠŸåˆ›ä½œè€…çš„ç­–ç•¥
- å‘ç°å¸‚åœºç©ºç™½æœºä¼š

### 4. æ•°æ®ç›‘æ§
- å®šæœŸç›‘æ§çƒ­æ¦œå˜åŒ–
- è·Ÿè¸ªå‚ç±»å†…å®¹è¶‹åŠ¿
- é¢„æµ‹å†…å®¹å‘å±•æ–¹å‘

## API è´¹ç”¨

æ ¹æ® TikHub API å®šä»·:
- æ¯æ¬¡è¯·æ±‚: $0.001 USD
- ä»…åœ¨è¿”å›çŠ¶æ€ç  200 æ—¶è®¡è´¹
- ä¸ç¼“å­˜ï¼Œå®æ—¶è·å–æœ€æ–°æ•°æ®

## æ•…éšœæ’æŸ¥

### 1. è¿æ¥å¤±è´¥

**é”™è¯¯**: `TikHub APIè¿æ¥å¤±è´¥`

**è§£å†³æ–¹æ³•**:
- æ£€æŸ¥ `TIKHUB_API_KEY` æ˜¯å¦æ­£ç¡®é…ç½®
- ç¡®è®¤ API Key æ˜¯å¦æœ‰æ•ˆ
- æ£€æŸ¥ç½‘ç»œè¿æ¥

### 2. 401 è®¤è¯é”™è¯¯

**é”™è¯¯**: `é”™è¯¯ç : 401`

**è§£å†³æ–¹æ³•**:
- API Key æ— æ•ˆæˆ–å·²è¿‡æœŸ
- é‡æ–°ç”Ÿæˆ API Key å¹¶æ›´æ–° `.env.local`

### 3. å“åº”æ•°æ®æ ¼å¼é”™è¯¯

**é”™è¯¯**: `å“åº”æ•°æ®æ ¼å¼é”™è¯¯`

**è§£å†³æ–¹æ³•**:
- æ£€æŸ¥ API ç«¯ç‚¹æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹å®Œæ•´å“åº”å†…å®¹ï¼ˆä¼šåœ¨é”™è¯¯æ—¶è¾“å‡ºï¼‰
- æ›´æ–°ç±»å‹å®šä¹‰ä»¥åŒ¹é…å®é™… API å“åº”

### 4. ç©ºæ•°æ®åˆ—è¡¨

**é—®é¢˜**: `æœ¬é¡µæ•°é‡: 0`

**å¯èƒ½åŸå› **:
- å‚ç±»IDä¸æ­£ç¡®
- è¯¥å‚ç±»æš‚æ—¶æ²¡æœ‰çƒ­é—¨è§†é¢‘
- æ—¶é—´çª—å£è®¾ç½®ä¸å½“

**è§£å†³æ–¹æ³•**:
- ä½¿ç”¨ `test-content-tags.ts` ç¡®è®¤æ­£ç¡®çš„å‚ç±»ID
- è°ƒæ•´æ—¶é—´çª—å£å‚æ•°
- å°è¯•æŸ¥è¯¢å…¨éƒ¨å‚ç±»ï¼ˆä¸ä½¿ç”¨ `--tag` å‚æ•°ï¼‰

## æŠ€æœ¯å®ç°

### æ ¸å¿ƒåŠŸèƒ½

1. **POSTè¯·æ±‚æ”¯æŒ** - ä½¿ç”¨POSTæ–¹æ³•å‘é€è¯·æ±‚ä½“
2. **å‚ç±»æ ‡ç­¾é›†æˆ** - æ”¯æŒå•ä¸ªæˆ–å¤šä¸ªå‚ç±»æ ‡ç­¾æŸ¥è¯¢
3. **æ•°å­—æ ¼å¼åŒ–** - æ’­æ”¾æ•°å’Œç‚¹èµæ•°ä½¿ç”¨ä¸‡/äº¿å•ä½
4. **æ—¶é—´æ ¼å¼åŒ–** - æ˜¾ç¤ºç›¸å¯¹æ—¶é—´ï¼ˆXå¤©å‰ã€Xå°æ—¶å‰ï¼‰
5. **å‘½ä»¤è¡Œå‚æ•°** - çµæ´»çš„å‚æ•°é…ç½®

### è®¾è®¡ç‰¹ç‚¹

- âœ… ç±»å‹å®‰å…¨ - å®Œæ•´çš„ TypeScript ç±»å‹å®šä¹‰
- âœ… é”™è¯¯å¤„ç† - å®Œå–„çš„é”™è¯¯æ•è·å’Œæç¤º
- âœ… æ•°æ®æ ¼å¼åŒ– - ç¾è§‚çš„æ•°å­—å’Œæ—¶é—´æ˜¾ç¤º
- âœ… æ•°æ®å¯¼å‡º - è‡ªåŠ¨ä¿å­˜ JSON æ ¼å¼æ•°æ®
- âœ… å‘½ä»¤è¡Œå‹å¥½ - æ”¯æŒå‚æ•°é…ç½®

## ç›¸å…³æ–‡ä»¶

- **æµ‹è¯•è„šæœ¬**: `scripts/test-hot-video-list.ts`
- **ç±»å‹å®šä¹‰**: `lib/tikhub/types.ts` (HotVideoInfo, GetHotVideoListParams, DouyinHotVideoListResponse)
- **å®¢æˆ·ç«¯æ–¹æ³•**: `lib/tikhub/client.ts` (getHotVideoList)

## åœ¨ä»£ç ä¸­ä½¿ç”¨

```typescript
import { getTikHubClient } from '@/lib/tikhub'
import type { HotVideoListTag } from '@/lib/tikhub/types'

async function getHotVideosExample() {
  const client = getTikHubClient()

  // è·å–å…¨éƒ¨å‚ç±»çƒ­é—¨è§†é¢‘
  const allHotVideos = await client.getHotVideoList({
    page: 1,
    page_size: 20,
    date_window: 24
  })

  console.log(`è·å–åˆ° ${allHotVideos.data.objs.length} ä¸ªçƒ­é—¨è§†é¢‘`)
  console.log(`æ€»æ•°: ${allHotVideos.data.page.total}`)

  // è·å–ç¾é£Ÿå‚ç±»çƒ­é—¨è§†é¢‘
  const foodHotVideos = await client.getHotVideoList({
    page: 1,
    page_size: 10,
    date_window: 24,
    tags: [{ value: 628 }]
  })

  // å¤„ç†è§†é¢‘æ•°æ®
  foodHotVideos.data.objs.forEach(video => {
    console.log(`${video.item_title}`)
    console.log(`  ä½œè€…: ${video.nick_name}`)
    console.log(`  æ’­æ”¾: ${video.play_cnt}`)
    console.log(`  çƒ­åº¦: ${video.score}`)
  })
}
```

### æ„å»ºæŸ¥è¯¢å‚æ•°

```typescript
import type { HotVideoListTag } from '@/lib/tikhub/types'

// å•ä¸ªå‚ç±»
const tags1: HotVideoListTag[] = [{ value: 628 }]

// å‚ç±» + å­å‚ç±»
const tags2: HotVideoListTag[] = [
  {
    value: 628,
    children: [
      { value: 62808 }, // å“é…’æ•™å­¦
      { value: 62804 }  // ç¾é£Ÿæ•™ç¨‹
    ]
  }
]

// å…¨éƒ¨å‚ç±»ï¼ˆç©ºæ•°ç»„ï¼‰
const tagsAll: HotVideoListTag[] = []
```

## è®¸å¯è¯

æœ¬é¡¹ç›®éµå¾ªé¡¹ç›®ä¸»ä»“åº“çš„è®¸å¯è¯ã€‚
